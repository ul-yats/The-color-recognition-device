# Алгоритм распознавания цветов

В качестве алгоритма для распознавания цветов был выбран принцип сравнения с эталоном, который заключается в сопоставлении полученных значений с определённым набором эталонных величин. 
На рисунке 1 представлена блок-схема алгоритма:

![изображение](https://github.com/ul-yats/The-color-recognition-device/assets/127503480/842559fc-de52-4d20-88ff-856435557e2e)
<p><b>Рисунок 1 — Блок-схема алгоритма</p></b>

В данной работе в качестве эталонных выступали ранее снятые значения 
напряжения, поступающие на вход с фотодиода. Далее, исходя из полученных 
значений, по формуле (2) были найдены доверительные интервалы, 
соответствующие каждому цвету:

<b>CI= ̅x±z*s/√n,(2)</b>

де CI — доверительный интервал, ̅x — среднее значение выборки, z — коэффициент доверия, s — стандартное отклонение, n — размер выборки.
В общем и целом, алгоритм выглядит так: зарегистрированные фотодиодом сигналы измеряются с помощью АЦП, переводятся в напряжение, усредняются и затем определяется, в какие диапазоны (доверительные интервалы) попадают снятые данные. 
Доверительные интервалы были найдены для образцов разных цветов при их освещении светодиодами различных длин волн (красного, синего, зелёного и белого цветов), в результате чего получилось, что каждому цвету соответствуют четыре доверительных интервала. 
На рисунке 2 изображена электрическая схема исследуемой цепи:

![изображение](https://github.com/ul-yats/The-color-recognition-device/assets/127503480/cbc86ab6-9a18-4e3e-9ac8-4323b2aabb00)
<p><b>Рисунок 2 — Электрическая схема исследуемой цепи</p></b>

При создании цепи использовались:  фотодиод BPW21R (2), RGB светодиод (3), светодиод с длиной волны 400-669 нм (4), которые помещены в, так называемую, “вагонетку” (6), четыре резистора 220 Ом, соединительные провода типа папа-папа и мама-папа, беспаечная макетная плата и плата Arduino UNO (1). На “рельсе” (5) расположены образцы исследования (7).
На рисунке 3 представлена исследуемая цепь:

![изображение](https://github.com/ul-yats/The-color-recognition-device/assets/127503480/072f51d4-3d04-4d9b-bb5e-3bd276b59a54)
<p><b>Рисунок 3 — Исследуемая цепь</p></b>

Изначально в качестве объектов исследования были использованы жевательные конфеты Skittles различных цветов, однако в процессе работы было установлено, что полученные значения сильно зависят от геометрии самой конфеты, а также от расстояния, на котором расположен образец исследования от фотодиода. Вследствие ранее описанных факторов, далее в качестве объектов исследования были использованы листы цветной бумаги.
После подачи напряжения, микроконтроллер считывает с   фотодиода цифровой сигнал, который пересчитывается в напряжение. Сначала значения снимаются при свечении красного светодиода, затем зелёного, синего и белого, все полученные данные записываются в отдельные массивы, соответствующие каждому светодиоду. Далее, после снятия ста значений напряжения для каждого светодиода, высчитываются средние всех четырёх массивов и полученные значения сравниваются с заданными в среде разработки интервалами, и, в зависимости от количества совпадений определяется цвет образца. 
В Таблицe 1 содержатся установленные доверительные интервалы для образцов различных цветов.
В результате «освещения» светодиодами с различными длинами волн пяти образцов красного цвета, выложенных поочередно на «рельсу», в четырёх из пяти случаев цвет был определён верно. В другом случае цвет определён не был, так как вычисленные средние массивов попали в интервалы сразу нескольких цветов. Данную ошибку всё также можно списать на зависимость полученного результата от расстояния между фотодиодом и образцом. 
Далее на «рельсу» были выложены образцы красного, синего и зелёного цветов, которые были поочередно шесть раз освещены светодиодами различных длин волн. В результате цвет красного образца все шесть раз был определён верно. В четырёх из шести случаев цвет образцов зелёного и синего цветов были также определены верно. В двух других случаях программа «путала» между собой образцы синего и зелёного цветов. Данное явление можно объяснить тем, что результат зависит от расстояния между фотодиодом и образцом, и что значения доверительных интервалов для зелёного и синего цветов близки друг к другу.
Далее в качестве образцов для исследования был взят глянцевый цветной картон. Полученные результаты оказались схожи с предыдущими, когда в качестве объекта исследования выступала цветная бумага. В случае с красным образцом в четырёх из пяти случаев цвет был определён верно. В результате освещения поочерёдно выложенных образцов красного, синего и зелёного цветов в пяти из шести случаев красный цвет был определён верно. Однако, по аналогии с предыдущим экспериментом, в результате освещения образцов зелёного цвета в одном из шести случаев цвет был определён как синий. При освещении образцов синего цвета все шесть раз цвет был определён верно.

Таблица 1 — Доверительные интервалы, соответствующие для образцов различных цветов. 

![изображение](https://github.com/ul-yats/The-color-recognition-device/assets/127503480/a2190123-76cd-44b4-82a8-3d067dd8998b)


